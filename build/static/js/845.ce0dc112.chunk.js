"use strict";(self.webpackChunkhexadash_tailwind=self.webpackChunkhexadash_tailwind||[]).push([[845],{78845:(e,t,l)=>{l.r(t),l.d(t,{default:()=>V});var s=l(65043),i=l(33307),r=l(50525),n=l(89421),a=l(28440),o=l(47419),d=l(11645),c=l(94406),m=l(33946),x=l(37122),u=l(64435),h=l(10444),p=l(86178),g=l.n(p),y=l(48646),j=l(78240),A=l(50289),b=l(48193),f=l(5397),v=l(3428),S=l(88655),w=l(53815),I=l(47807),k=l(2543),C=l(89680),_=l(70579);const{Option:z}=c.A,N=e=>{let{setisAddCms:t,getAllData:l,setIsEditCms:r,isEditCms:a,currentStore:m}=e;const[x,u]=(0,s.useState)(!1),[h,p]=(0,s.useState)([]),[g,y]=(0,s.useState)(""),[j,N]=(0,s.useState)(!1),[F,P]=(0,s.useState)([]),[T,O]=(0,s.useState)({orderNumber:"",tableNumber:"",items:[],subtotal:0,tax:0,total:0}),[D]=A.A.useForm();(0,s.useEffect)((()=>{null!==a&&void 0!==a&&a.cmsId&&(u(!0),(0,w.W8)({id:null===a||void 0===a?void 0:a.cmsId}).then((e=>{D.setFieldsValue(null===e||void 0===e?void 0:e.data);let t=null===e||void 0===e?void 0:e.data,l={orderNumber:t.id,tableNumber:t.table_number,items:t.order_items,subtotal:t.total_price||0,tax:t.tax_precent||0,total:t.total_price||0,organisation:t.Organisation};O(l),u(!1)})).catch((e=>{console.log("err",e),u(!1)})))}),[null===a||void 0===a?void 0:a.cmsId]),(0,s.useEffect)((()=>{(0,I.hV)({search:g}).then((e=>{p(e.data.rows)})).catch((e=>{b.Ay.error("Error While Fetching Items")}))}),[g]),(0,s.useEffect)((()=>{(0,k.xH)({}).then((e=>{P(e.data.rows)})).catch((e=>{b.Ay.error("Error While Fetching Items")}))}),[]);const q=()=>{var e;let t=D.getFieldsValue(["order_items"]),l=0;null===t||void 0===t||null===(e=t.order_items)||void 0===e||e.map((e=>{let t=Number(null===e||void 0===e?void 0:e.price)*Number(null===e||void 0===e?void 0:e.quantity);l+=t}));let s=D.getFieldValue("tax_precent"),i=D.getFieldValue("discount_precent");l+=.01*s*l,l-=.01*i*l,D.setFieldValue("total_price",l)};return(0,_.jsxs)(_.Fragment,{children:[(0,_.jsx)(f.A,{spinning:x,children:(0,_.jsx)("div",{children:(0,_.jsxs)(A.A,{name:"order",form:D,layout:"vertical",onFinish:e=>{const s=e;var i;null!==a&&void 0!==a&&a.cmsId?(0,w.FM)({id:null===a||void 0===a?void 0:a.cmsId,body:s}).then((e=>{r({isOpen:!1,cmsId:""}),l(),b.Ay.success("Data updated successfully")})).catch((e=>console.log("err",e))):(s.store_id=m,null===(i=(0,w.zF)({body:s}))||void 0===i||i.then((e=>{t(!1),l(),b.Ay.success("Data added successfully")})).catch((e=>{console.log("err :>> ",e)})))},onChange:q,autoComplete:"off",children:[(0,_.jsxs)(o.A,{gutter:16,children:[(0,_.jsx)(d.A,{span:12,children:(0,_.jsx)(A.A.Item,{label:"Table number",name:"table_id",rules:[{required:!0,message:"Please select the table ID"}],children:(0,_.jsx)(c.A,{children:F.map((e=>(0,_.jsxs)(z,{value:e.id,children:[e.table_number," - "," ("+e.no_of_seats+" Seater )"]})))})})}),(0,_.jsx)(d.A,{span:12,children:(0,_.jsx)(A.A.Item,{label:"Customer Name",name:"customer_name",children:(0,_.jsx)(i.A,{})})})]}),(0,_.jsxs)(o.A,{gutter:16,children:[(0,_.jsx)(d.A,{xs:12,sm:12,md:12,lg:8,children:(0,_.jsx)(A.A.Item,{label:"Total Price",name:"total_price",rules:[{required:!0,message:"Please enter the total price"}],children:(0,_.jsx)(v.A,{min:0,precision:2,style:{width:"100%"}})})}),(0,_.jsx)(d.A,{xs:12,sm:12,md:12,lg:8,children:(0,_.jsx)(A.A.Item,{label:"Discount Percent",name:"discount_precent",initialValue:0,children:(0,_.jsx)(v.A,{min:0,max:100,precision:2,style:{width:"100%"}})})}),(0,_.jsx)(d.A,{xs:12,sm:12,md:12,lg:8,children:(0,_.jsx)(A.A.Item,{label:"Tax Percent",name:"tax_precent",initialValue:0,children:(0,_.jsx)(v.A,{min:0,max:100,precision:2,style:{width:"100%"}})})})]}),(0,_.jsx)(o.A,{gutter:16,children:(0,_.jsx)(d.A,{xs:12,sm:12,md:12,lg:8,children:(0,_.jsx)(A.A.Item,{label:"Order Status",name:"status",initialValue:"pending",children:(0,_.jsxs)(c.A,{children:[(0,_.jsx)(z,{value:"pending",children:"Pending"}),(0,_.jsx)(z,{value:"preparing",children:"Preparing"}),(0,_.jsx)(z,{value:"served",children:"Served"}),(0,_.jsx)(z,{value:"paid",children:"Paid"}),(0,_.jsx)(z,{value:"canceled",children:"Canceled"})]})})})}),(0,_.jsx)(A.A.List,{name:"order_items",children:(e,t)=>{let{add:l,remove:s}=t;return(0,_.jsxs)(_.Fragment,{children:[e.map((e=>{let{key:t,name:l,fieldKey:r,...n}=e;return(0,_.jsxs)(_.Fragment,{children:[(0,_.jsx)("hr",{style:{margin:"20px 0",borderColor:"#e8e8e8"}}),(0,_.jsxs)(o.A,{gutter:16,align:"middle",children:[(0,_.jsx)(d.A,{xs:12,sm:12,md:12,lg:6,children:(0,_.jsx)(A.A.Item,{...n,name:[l,"item_id"],fieldKey:[r,"item_id"],label:"Item Code",rules:[{required:!0,message:"Please select the item ID"}],children:(0,_.jsx)(c.A,{showSearch:!0,onSearch:e=>{y(e)},onChange:e=>{const t=h.find((t=>t.id===e));D.setFieldsValue({order_items:{[l]:{item_name:null===t||void 0===t?void 0:t.name,price:null===t||void 0===t?void 0:t.price,quantity:1}}}),q()},children:h.map((e=>(0,_.jsxs)(z,{value:e.id,children:[e.item_code," - ",e.name]},e.id)))})})}),(0,_.jsx)(d.A,{xs:12,sm:12,md:12,lg:6,children:(0,_.jsx)(A.A.Item,{...n,name:[l,"item_name"],fieldKey:[r,"item_name"],label:"Item Name",rules:[{required:!0,message:"Please enter the item name"}],children:(0,_.jsx)(i.A,{})})}),(0,_.jsx)(d.A,{xs:8,sm:12,md:12,lg:4,children:(0,_.jsx)(A.A.Item,{...n,name:[l,"quantity"],fieldKey:[r,"quantity"],label:"Quantity",rules:[{required:!0,message:"Please enter the quantity"}],children:(0,_.jsx)(v.A,{min:0,defaultValue:1,style:{width:"100%"}})})}),(0,_.jsx)(d.A,{xs:12,sm:12,md:12,lg:6,children:(0,_.jsx)(A.A.Item,{...n,name:[l,"price"],fieldKey:[r,"price"],label:"Unit Price",rules:[{required:!0,message:"Please enter the price"}],children:(0,_.jsx)(v.A,{min:0,precision:2,style:{width:"100%"}})})}),(0,_.jsx)(d.A,{span:2,children:(0,_.jsx)(S.A,{onClick:()=>{s(l),q()},style:{fontSize:"20px",color:"red"}})})]},t)]})})),(0,_.jsx)(A.A.Item,{children:(0,_.jsx)(n.A,{type:"dashed",onClick:()=>l(),block:!0,children:"Add Item"})})]})}}),(0,_.jsxs)("div",{className:"flex justify-end gap-2 mt-5",children:[(0,_.jsx)(n.A,{onClick:()=>{t(!1)},children:"Cancel"}),(0,_.jsx)(n.A,{onClick:()=>{N(!j)},children:"View Bill"}),(0,_.jsx)(n.A,{type:"primary",htmlType:"submit",loading:x,children:"Submit"})]})]})})}),(0,_.jsx)("div",{className:"mt-4",children:j&&(0,_.jsx)(C.A,{orderDetails:T})})]})};var F=l(40925),P=l(91734),T=l(57043),O=l(70495);const{Search:D}=i.A,{RangePicker:q}=r.A,V=()=>{const[e,t]=(0,s.useState)(!1),[l,i]=(0,s.useState)(0),[r,p]=(0,s.useState)(""),[A,b]=(0,s.useState)({isOpen:!1,cmsId:""}),[f,v]=(0,s.useState)([]),[S,I]=(0,s.useState)(0),[k,C]=(0,s.useState)(""),[z,D]=(0,s.useState)([]),[V,B]=(0,x.fp)(O.qt),E=[{title:"#Id",dataIndex:"id",key:"id",width:140},{title:"Total Price",dataIndex:"total_price",key:"total_price",width:140},{title:"Status",dataIndex:"status",key:"status",width:140},{title:"Date",dataIndex:"createdAt",render:(e,t)=>g()(t.createdAt).format("DD-MM-YYYY (HH:mm)"),width:140},{title:"Table",dataIndex:"table_id",key:"table_id",width:150},{title:"Action",key:"action",render:(e,t)=>(0,_.jsxs)(u.A,{size:"middle",children:[(0,_.jsx)(n.A,{size:"small",onClick:()=>b({isOpen:!0,cmsId:null===t||void 0===t?void 0:t.id}),children:(0,_.jsx)(y.A,{})}),(0,_.jsx)(a.A,{title:"Are you sure to delete this task?",onConfirm:()=>{(0,w.FN)({id:null===t||void 0===t?void 0:t._id}).then((e=>{console.log("res",e),message.success("Deleted Successfully"),R()})).catch((e=>console.log("err",e)))},okText:"Yes",cancelText:"No",children:(0,_.jsx)(n.A,{danger:!0,size:"small",children:(0,_.jsx)(j.A,{})})})]}),width:150}],R=()=>{(0,w.hV)({start:l,limit:10,search:r,status:k,dates:z,currentStore:V}).then((e=>{var t,l;e&&(v(null===e||void 0===e||null===(t=e.data)||void 0===t?void 0:t.rows),I(null===e||void 0===e||null===(l=e.data)||void 0===l?void 0:l.count))})).catch((e=>console.log("err",e)))};(0,s.useEffect)((()=>{R()}),[l,r,k,z,V]);return(0,_.jsxs)(_.Fragment,{children:[(0,_.jsx)(P.z,{title:"Orders",routes:[{path:"/",breadcrumbName:"Dashboard"},{path:"/products",breadcrumbName:"Products"}],className:"flex items-center justify-between px-8 xl:px-[15px] pt-2 pb-6 sm:pb-[30px] bg-transparent sm:flex-col"}),(0,_.jsx)(F.rQ,{className:"p-3",children:(0,_.jsx)(o.A,{gutter:16,children:(0,_.jsx)(d.A,{sm:24,xs:24,lg:24,className:"",children:(0,_.jsx)(T.C,{title:(0,_.jsx)("div",{children:(0,_.jsxs)(o.A,{gutter:[16,16],align:"middle",children:[(0,_.jsx)(d.A,{xs:24,sm:12,md:8,lg:6,children:(0,_.jsxs)(c.A,{style:{width:"100%"},size:"middle",placeholder:"Status",onChange:e=>{C(e)},children:[(0,_.jsx)(Option,{value:"",children:"All"}),(0,_.jsx)(Option,{value:"pending",children:"Pending"}),(0,_.jsx)(Option,{value:"preparing",children:"Preparing"}),(0,_.jsx)(Option,{value:"served",children:"Served"}),(0,_.jsx)(Option,{value:"paid",children:"Paid"}),(0,_.jsx)(Option,{value:"canceled",children:"Canceled"})]})}),(0,_.jsx)(d.A,{xs:24,sm:12,md:8,lg:6,children:(0,_.jsx)(q,{size:"middle",onChange:(e,t)=>{D(t)},style:{width:"100%"}})})]})}),moreBtn:(0,_.jsx)(n.A,{type:"primary",onClick:()=>t(!0),children:"Add"}),children:(0,_.jsx)(h.A,{size:"small",scroll:{x:"100%",y:"auto"},columns:E,dataSource:f,pagination:{pageSize:10,total:S,showSizeChanger:!1},onChange:e=>{const{current:t}=e;i(10*(t-1))}})})})})}),(0,_.jsx)(m.A,{title:"".concat(e?"Add Order":"Edit Order"),destroyOnClose:!0,open:e||A.isOpen,width:1024,footer:!1,onCancel:()=>{t(!1),b({isOpen:!1,cmsId:""})},children:(0,_.jsx)(N,{setisAddCms:t,getAllData:R,isEditCms:A,setIsEditCms:b,currentStore:V})})]})}},89680:(e,t,l)=>{l.d(t,{A:()=>A});var s=l(65043),i=l(37122),r=l(77047),n=l(48193),a=l(39998),o=l(10444),d=l(89421),c=l(45904),m=l(65239),x=l.n(m),u=l(18233),h=l.n(u),p=l(70495),g=l(70579);const{Title:y,Text:j}=r.A,A=e=>{var t,l;let{orderDetails:r}=e;const m=(0,s.useRef)(null),u=(0,s.useRef)(null),[A,b]=(0,i.fp)(p.Zr),f=(new Date).toLocaleString(),[v,S]=(0,s.useState)(.01*Number(r.tax)*Number(r.total)),[w,I]=(0,s.useState)(0);(0,s.useEffect)((()=>{let e=0;r.items.forEach((t=>{e+=t.price*t.quantity})),I(e)}),[]);return(0,g.jsxs)("div",{children:[(0,g.jsxs)("div",{ref:m,style:{padding:"10px",width:"80mm",backgroundColor:"#fff",margin:"auto",fontFamily:"Arial, sans-serif",border:"1px solid #000",color:"#000"},children:[(0,g.jsx)(y,{level:5,style:{marginBottom:"5px"},children:A.name}),(0,g.jsx)(j,{style:{textAlign:"center",display:"block",fontSize:"12px",color:"#000"},children:A.address}),(0,g.jsxs)(j,{style:{textAlign:"center",display:"block",fontSize:"10px",color:"#000"},children:["Phone: ",A.phoneNumber]}),(0,g.jsxs)(j,{style:{textAlign:"center",display:"block",fontSize:"12px",marginBottom:"10px",color:"#000"},children:["GSTIN: ",null===r||void 0===r||null===(t=r.organisation)||void 0===t?void 0:t.gst]}),(0,g.jsx)(a.A,{style:{borderColor:"#000",margin:"0"}}),(0,g.jsxs)(j,{style:{textAlign:"left",fontSize:"12px",color:"#000"},children:["Name: ",r.customer_name]}),(0,g.jsx)(a.A,{style:{borderColor:"#000",margin:"0"}}),(0,g.jsx)("br",{}),(0,g.jsxs)(j,{style:{textAlign:"left",display:"block",fontSize:"12px",color:"#000"},children:["Date: ",f]}),(0,g.jsxs)(j,{style:{fontSize:"12px",color:"#000"},children:["Bill No: ",r.orderNumber]}),(0,g.jsx)("br",{}),(0,g.jsxs)(j,{style:{fontSize:"12px",color:"#000"},children:["Table: ",r.tableNumber]}),(0,g.jsx)(a.A,{style:{borderColor:"#000"}}),(0,g.jsx)(o.A,{dataSource:r.items,columns:[{title:"Item",dataIndex:"item_name",key:"item_name"},{title:"Qty",dataIndex:"quantity",key:"quantity",align:"center"}],pagination:!1,size:"small",style:{marginBottom:"10px",color:"#000"}}),(0,g.jsx)(a.A,{style:{borderColor:"#000"}}),(0,g.jsx)(j,{style:{textAlign:"center",display:"block",fontSize:"12px",color:"#000"},children:"Thank You Visit Again"})]}),(0,g.jsx)(d.A,{style:{marginTop:"20px"},onClick:()=>{const e=m.current;x()(e).then((e=>{const t=e.toDataURL("image/png"),l=new c.Ay("p","mm",[80,e.height*(80/e.width)]);l.addImage(t,"PNG",0,0,80,e.height*(80/e.width)),l.save("kot.pdf")}))},children:"Print KOT"}),(0,g.jsxs)("div",{ref:u,style:{padding:"10px",width:"80mm",backgroundColor:"#fff",margin:"auto",fontFamily:"Arial, sans-serif",border:"1px solid #000",marginTop:"40px"},children:[(0,g.jsx)("style",{children:"\n                    .custom-row {\n                        color: #000 !important; \n                    }\n                    .custom-row td {\n                        color: #000 !important; \n                    }\n                "}),(0,g.jsx)(y,{level:5,style:{marginBottom:"5px"},children:A.name}),(0,g.jsx)(j,{style:{textAlign:"center",display:"block",fontSize:"12px",color:"#000"},children:A.address}),(0,g.jsxs)(j,{style:{textAlign:"center",display:"block",fontSize:"10px",color:"#000"},children:["Phone: ",A.phoneNumber]}),(0,g.jsxs)(j,{style:{textAlign:"center",display:"block",fontSize:"12px",marginBottom:"10px",color:"#000"},children:["GSTIN: ",null===r||void 0===r||null===(l=r.organisation)||void 0===l?void 0:l.gst]}),(0,g.jsx)(a.A,{style:{borderColor:"#000",margin:"0"}}),(0,g.jsxs)(j,{style:{textAlign:"left",fontSize:"12px",color:"#000"},children:["Name: ",r.customer_name]}),(0,g.jsx)(a.A,{style:{borderColor:"#000",margin:"0",color:"#000"}}),(0,g.jsx)("br",{}),(0,g.jsxs)(j,{style:{textAlign:"left",display:"block",fontSize:"12px",color:"#000"},children:["Date: ",f]}),(0,g.jsxs)(j,{style:{fontSize:"12px",color:"#000"},children:["Bill No: ",r.orderNumber]}),(0,g.jsx)("br",{}),(0,g.jsxs)(j,{style:{fontSize:"12px",color:"#000"},children:["Table: ",r.tableNumber]}),(0,g.jsx)(a.A,{style:{borderColor:"#000"}}),(0,g.jsx)(o.A,{dataSource:r.items,columns:[{title:"Item",dataIndex:"item_name",key:"item_name"},{title:"Qty",dataIndex:"quantity",key:"quantity",align:"center"},{title:"Price",dataIndex:"price",key:"price",align:"center",render:e=>"".concat(e.toFixed(2))},{title:"Amount",key:"total",align:"center",render:e=>"".concat((e.quantity*e.price).toFixed(2))}],pagination:!1,rowClassName:"custom-row",size:"small",style:{marginBottom:"10px"}}),(0,g.jsxs)(j,{style:{textAlign:"right",display:"block",fontSize:"14px",color:"#000"},children:[(0,g.jsx)("strong",{children:"Sub Total "})," ",w]}),(0,g.jsxs)(j,{style:{textAlign:"right",display:"block",fontSize:"14px",color:"#000",marginBottom:"10px"},children:[(0,g.jsx)("strong",{children:"gst "})," ",r.tax,"% ",v.toFixed(2)]}),(0,g.jsx)(a.A,{style:{borderColor:"#000",margin:"0"}}),(0,g.jsx)(j,{style:{textAlign:"right",display:"block",fontSize:"10px",color:"#000"},children:"round off: 0.01"}),(0,g.jsx)(j,{style:{textAlign:"right",display:"block",fontSize:"16px",color:"#000",marginBottom:"10px"},children:(0,g.jsxs)("strong",{children:["Grand Total \u20b9 ",r.total]})}),(0,g.jsx)(a.A,{style:{borderColor:"#000",margin:"0"}}),(0,g.jsx)("br",{}),(0,g.jsx)(j,{style:{textAlign:"center",display:"block",fontSize:"14px",marginTop:"10px",color:"#000"},children:"Thank You Visit Again..."})]}),(0,g.jsx)(d.A,{style:{marginTop:"20px"},onClick:()=>{try{const e=u.current;x()(e).then((e=>{const t=e.toDataURL("image/png"),l=new c.Ay("p","mm",[80,e.height*(80/e.width)]);l.addImage(t,"PNG",0,0,80,e.height*(80/e.width));const s=l.output("blob"),i=URL.createObjectURL(s);h()({printable:i,type:"pdf",documentTitle:"Order Bill"})}))}catch(e){n.Ay.warning("Error While Printing Bill")}},children:"Download Bill"})]})}},53815:(e,t,l)=>{l.d(t,{FM:()=>a,FN:()=>o,W8:()=>n,hV:()=>r,zF:()=>i});var s=l(32170);const i=async e=>{let{body:t}=e;return await s.p.post("/orders",t)},r=async e=>{let{start:t,limit:l,status:i,search:r,dates:n,currentStore:a}=e,o=r?"&search=".concat(r):"",d=i?"&status=".concat(i):"",c=a?"&store_id=".concat(a):"",m="";2===n.length&&(m="&start_date=".concat(n[0],"&end_date=").concat(n[1]));return await s.p.get("/orders?start=".concat(t,"&limit=").concat(l).concat(o).concat(d).concat(m).concat(c))},n=async e=>{let{id:t}=e;return await s.p.get("/orders/".concat(t))},a=async e=>{let{id:t,body:l}=e;return await s.p.patch("/orders/".concat(t),l)},o=async e=>{let{id:t}=e;return await s.p.delete("/orders/".concat(t))}},47807:(e,t,l)=>{l.d(t,{FM:()=>a,FN:()=>o,W8:()=>n,hV:()=>r,zF:()=>i});var s=l(32170);const i=async e=>{let{body:t}=e;return await s.p.post("/restroItems",t)},r=async e=>{let{start:t=0,limit:l=10,search:i}=e,r=i?"&search=".concat(i):"";return await s.p.get("/restroItems?start=".concat(t,"&limit=").concat(l).concat(r))},n=async e=>{let{id:t}=e;return await s.p.get("/restroItems/".concat(t))},a=async e=>{let{id:t,body:l}=e;return await s.p.patch("/restroItems/".concat(t),l)},o=async e=>{let{id:t}=e;return await s.p.delete("/restroItems/".concat(t))}},2543:(e,t,l)=>{l.d(t,{FM:()=>a,W8:()=>n,xH:()=>r,zF:()=>i});var s=l(32170);const i=async e=>{let{body:t}=e;return await s.p.post("/tables",t)},r=async e=>{let{start:t=0,limit:l=10,search:i,type:r,isAvailable:n,store_id:a}=e,o=i?"&search=".concat(i):"",d=r?"&status=".concat(r):"",c=a?"&store_id=".concat(a):"",m=n?"&isAvailable=".concat(n):"";return await s.p.get("/tables?start=".concat(t,"&limit=").concat(l).concat(o).concat(d).concat(m).concat(c))},n=async e=>{let{id:t}=e;return await s.p.get("/tables/".concat(t))},a=async e=>{let{id:t,body:l}=e;return await s.p.patch("/tables/".concat(t),l)}}}]);
//# sourceMappingURL=845.ce0dc112.chunk.js.map