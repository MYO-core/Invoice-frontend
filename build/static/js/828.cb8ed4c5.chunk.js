"use strict";(self.webpackChunkhexadash_tailwind=self.webpackChunkhexadash_tailwind||[]).push([[828],{828:(e,t,s)=>{s.r(t),s.d(t,{default:()=>L});var l=s(5043),r=s(7122),a=s(3307),i=s(9800),n=s(1645),d=s(4406),c=s(1802),o=s(9602),m=s(3946),u=s(1554),h=s(289),x=s(8193),j=s(5397),p=s(3428),b=s(1966),A=s(2543),g=s(579);const{Option:v}=d.A,y=e=>{let{setisAddCms:t,getAllData:s,setIsEditCms:r,isEditCms:o,currentStore:m,setNewRecord:u,newRecord:y}=e;const[f,_]=(0,l.useState)(!1),[S]=h.A.useForm();return(0,l.useEffect)((()=>{null!==o&&void 0!==o&&o.cmsId&&(_(!0),(0,A.W8)({id:null===o||void 0===o?void 0:o.cmsId}).then((e=>{S.setFieldsValue({tables:[null===e||void 0===e?void 0:e.data]}),_(!1)})).catch((e=>{console.log("err",e),_(!1)})))}),[null===o||void 0===o?void 0:o.cmsId]),(0,g.jsx)(g.Fragment,{children:(0,g.jsx)(j.A,{spinning:f,children:(0,g.jsx)("div",{children:(0,g.jsxs)(h.A,{form:S,layout:"vertical",onFinish:e=>{const s=e.tables.map((e=>({...e,store_id:m})));if(null!==o&&void 0!==o&&o.cmsId){var l,a,i;let e={no_of_seats:null===(l=s[0])||void 0===l?void 0:l.no_of_seats,status:null===(a=s[0])||void 0===a?void 0:a.status,table_number:null===(i=s[0])||void 0===i?void 0:i.table_number};(0,A.FM)({id:null===o||void 0===o?void 0:o.cmsId,body:e}).then((e=>{r({isOpen:!1,cmsId:""}),u(y+1),x.Ay.success("Data updated successfully")})).catch((e=>console.log("err",e)))}else{var n;null===(n=(0,A.zF)({body:s}))||void 0===n||n.then((e=>{t(!1),u(y+1),x.Ay.success("Tables added successfully")})).catch((e=>{console.log("err :>> ",e)}))}},initialValues:{tables:[{status:"booked"}]},children:[(0,g.jsx)(h.A.List,{name:"tables",children:(e,t)=>{let{add:s,remove:l}=t;return(0,g.jsxs)(g.Fragment,{children:[e.map(((t,s)=>(0,g.jsx)("div",{style:{marginBottom:20},children:(0,g.jsxs)(i.A,{gutter:16,align:"middle",children:[(0,g.jsx)(n.A,{xs:24,sm:24,md:24,lg:8,children:(0,g.jsx)(h.A.Item,{...t,label:"Table Number ".concat(s+1),name:[t.name,"table_number"],fieldKey:[t.fieldKey,"table_number"],rules:[{type:"string",message:"Table number must be a string."}],children:(0,g.jsx)(a.A,{placeholder:"Enter table number"})})}),(0,g.jsx)(n.A,{xs:24,sm:24,md:24,lg:8,children:(0,g.jsx)(h.A.Item,{...t,label:"Number of Seats",name:[t.name,"no_of_seats"],fieldKey:[t.fieldKey,"no_of_seats"],rules:[{required:!0,message:"Please enter the number of seats."},{type:"number",min:1,message:"Number of seats must be at least 1."}],children:(0,g.jsx)(p.A,{min:1,placeholder:"Enter number of seats",style:{width:"100%"}})})}),(0,g.jsx)(n.A,{xs:12,sm:12,md:12,lg:6,children:(0,g.jsx)(h.A.Item,{...t,label:"Status",name:[t.name,"status"],fieldKey:[t.fieldKey,"status"],rules:[{required:!0,message:"Please select the status."}],children:(0,g.jsxs)(d.A,{placeholder:"Select status",children:[(0,g.jsx)(v,{value:"available",children:"Available"}),(0,g.jsx)(v,{value:"booked",children:"Booked"}),(0,g.jsx)(v,{value:"service",children:"Service"}),(0,g.jsx)(v,{value:"preparing",children:"Preparing"})]})})}),(0,g.jsx)(n.A,{span:2,children:e.length>1&&(0,g.jsx)(b.A,{onClick:()=>l(t.name),style:{fontSize:"20px",color:"#ff4d4f",cursor:"pointer",marginTop:"30px"}})})]})},t.key))),!(null!==o&&void 0!==o&&o.cmsId)&&(0,g.jsx)(h.A.Item,{children:(0,g.jsx)(c.A,{type:"dashed",onClick:()=>s(),style:{width:"60%"},block:!0,children:"Add Another Table"})})]})}}),(0,g.jsxs)(h.A.Item,{style:{textAlign:"right"},children:[(0,g.jsx)(c.A,{onClick:()=>t(!1),style:{marginRight:8},children:"Cancel"}),(0,g.jsx)(c.A,{type:"primary",htmlType:"submit",children:"Submit"})]})]})})})})};var f=s(8655),_=s(3815),S=s(7807);const{Option:w}=d.A,C=e=>{let{tableData:t,setVisible:s,visible:r,currentStore:o,allCms:m,setAllCms:u}=e;const[b,A]=(0,l.useState)(!1),[v,y]=(0,l.useState)([]),[C,I]=(0,l.useState)(""),[F,k]=(0,l.useState)([]),[N]=h.A.useForm(),T=(e,s)=>{let l=m.map((l=>l.id===t.id?(l.status=s,l.current_order=e,l):l));u(l)};(0,l.useEffect)((()=>{(0,S.hV)({}).then((e=>{y(e.data.rows)})).catch((e=>{x.Ay.error("Error While Fetching Items")}))}),[N,C]),(0,l.useEffect)((()=>{k([])}),[]);(0,l.useEffect)((()=>{var e;r&&(N.resetFields(),N.setFieldsValue({table_id:t.id}),t.current_order&&(e=t.current_order,A(!0),(0,_.W8)({id:e}).then((e=>{N.setFieldsValue(null===e||void 0===e?void 0:e.data),A(!1)})).catch((e=>{var t;x.Ay.error((null===e||void 0===e||null===(t=e.data)||void 0===t?void 0:t.message)||"Something Went Wrong"),console.log("err",e),A(!1)}))))}),[N,r]);const O=()=>{var e;let t=N.getFieldsValue(["order_items"]),s=0;null===t||void 0===t||null===(e=t.order_items)||void 0===e||e.map((e=>{let t=Number(null===e||void 0===e?void 0:e.price)*Number(null===e||void 0===e?void 0:e.quantity);s+=t}));let l=N.getFieldValue("tax_precent"),r=N.getFieldValue("discount_precent");s+=.01*l*s,s-=.01*r*s,N.setFieldValue("total_price",s)};return(0,g.jsx)(g.Fragment,{children:(0,g.jsx)(j.A,{spinning:b,children:(0,g.jsx)("div",{children:(0,g.jsxs)(h.A,{name:"order",form:N,layout:"vertical",onChange:O,onFinish:e=>{const l=e;var r;(l.table_id=l.table_id.toString(),t.current_order)?(l.order_items=[...l.order_items,...F],(0,_.FM)({id:t.current_order,body:l}).then((e=>{let s="paid"===l.status?"available":"booked",r="paid"===l.status?null:t.current_order;T(r,s),x.Ay.success("Data updated successfully")})).catch((e=>{x.Ay.error("Something Went Wrong"),console.log("err :>> ",e)}))):(l.store_id=o,null===(r=(0,_.zF)({body:l}))||void 0===r||r.then((e=>{var t;let r="paid"===l.status?null:null===e||void 0===e||null===(t=e.data)||void 0===t?void 0:t.id,a="paid"===l.status?"available":"booked";T(r,a),x.Ay.success("Data added successfully"),s(!1)})).catch((e=>{x.Ay.error("Something Went Wrong"),console.log("err :>> ",e)})))},autoComplete:"off",children:[(0,g.jsxs)(i.A,{gutter:16,children:[(0,g.jsx)(n.A,{span:12,children:(0,g.jsx)(h.A.Item,{label:"Table number",name:"table_id",rules:[{required:!0,message:"Please select the table ID"}],children:(0,g.jsx)(d.A,{children:(0,g.jsxs)(w,{value:t.id,children:[t.table_number," - "," ("+t.no_of_seats+" Seater )"]})})})}),(0,g.jsx)(n.A,{span:12,children:(0,g.jsx)(h.A.Item,{label:"Customer Name",name:"customer_name",children:(0,g.jsx)(a.A,{})})})]}),(0,g.jsxs)(i.A,{gutter:16,children:[(0,g.jsx)(n.A,{xs:12,sm:12,md:12,lg:8,children:(0,g.jsx)(h.A.Item,{label:"Total Price",name:"total_price",rules:[{required:!0,message:"Please enter the total price"}],children:(0,g.jsx)(p.A,{min:0,precision:2,style:{width:"100%"}})})}),(0,g.jsx)(n.A,{xs:12,sm:12,md:12,lg:8,children:(0,g.jsx)(h.A.Item,{label:"Discount Percent",name:"discount_precent",initialValue:0,children:(0,g.jsx)(p.A,{min:0,max:100,precision:2,style:{width:"100%"}})})}),(0,g.jsx)(n.A,{xs:12,sm:12,md:12,lg:8,children:(0,g.jsx)(h.A.Item,{label:"Tax Percent",name:"tax_precent",initialValue:0,children:(0,g.jsx)(p.A,{min:0,max:100,precision:2,style:{width:"100%"}})})})]}),(0,g.jsx)(i.A,{gutter:16,children:(0,g.jsx)(n.A,{xs:12,sm:12,md:12,lg:8,children:(0,g.jsx)(h.A.Item,{label:"Order Status",name:"status",initialValue:"pending",children:(0,g.jsxs)(d.A,{children:[(0,g.jsx)(w,{value:"pending",children:"Pending"}),(0,g.jsx)(w,{value:"preparing",children:"Preparing"}),(0,g.jsx)(w,{value:"served",children:"Served"}),(0,g.jsx)(w,{value:"paid",children:"Paid"}),(0,g.jsx)(w,{value:"canceled",children:"Canceled"})]})})})}),(0,g.jsx)(h.A.List,{name:"order_items",children:(e,s)=>{let{add:l,remove:r}=s;return(0,g.jsxs)(g.Fragment,{children:[e.map((e=>{let{key:s,name:l,fieldKey:c,...o}=e;return(0,g.jsxs)(g.Fragment,{children:[(0,g.jsx)("hr",{style:{margin:"20px 0",borderColor:"#e8e8e8"}}),(0,g.jsxs)(i.A,{gutter:16,align:"middle",children:[(0,g.jsx)(n.A,{xs:12,sm:12,md:12,lg:6,children:(0,g.jsx)(h.A.Item,{...o,name:[l,"item_id"],fieldKey:[c,"item_id"],label:"Item Code",rules:[{required:!0,message:"Please select the item ID"}],children:(0,g.jsx)(d.A,{showSearch:!0,onSearch:e=>{I(e)},onChange:e=>{const t=v.find((t=>t.id===e));N.setFieldsValue({order_items:{[l]:{item_name:null===t||void 0===t?void 0:t.name,price:null===t||void 0===t?void 0:t.price,quantity:1}}}),O()},children:v.map((e=>(0,g.jsxs)(w,{value:e.id,children:[e.item_code," - ",e.name]},e.id)))})})}),(0,g.jsx)(n.A,{xs:12,sm:12,md:12,lg:6,children:(0,g.jsx)(h.A.Item,{...o,name:[l,"item_name"],fieldKey:[c,"item_name"],label:"Item Name",rules:[{required:!0,message:"Please enter the item name"}],children:(0,g.jsx)(a.A,{})})}),(0,g.jsx)(n.A,{xs:8,sm:12,md:12,lg:4,children:(0,g.jsx)(h.A.Item,{...o,name:[l,"quantity"],fieldKey:[c,"quantity"],label:"Quantity",rules:[{required:!0,message:"Please enter the quantity"}],children:(0,g.jsx)(p.A,{min:0,style:{width:"100%"}})})}),(0,g.jsx)(n.A,{xs:12,sm:12,md:12,lg:6,children:(0,g.jsx)(h.A.Item,{...o,name:[l,"price"],fieldKey:[c,"price"],label:"Unit Price",rules:[{required:!0,message:"Please enter the price"}],children:(0,g.jsx)(p.A,{min:0,precision:2,style:{width:"100%"}})})}),(0,g.jsx)(n.A,{span:2,children:(0,g.jsx)(f.A,{onClick:()=>{const e=N.getFieldValue("order_items")[l];if(r(l),t.current_order){console.log(F,e);let t=F;t.push({...e,deleted:!0}),k(t)}O()},style:{fontSize:"20px",color:"red"}})})]},s)]})})),(0,g.jsx)(h.A.Item,{children:(0,g.jsx)(c.A,{type:"dashed",onClick:()=>l(),block:!0,children:"Add Item"})})]})}}),(0,g.jsxs)("div",{className:"flex justify-end gap-2 mt-5",children:[(0,g.jsx)(c.A,{onClick:()=>{s(!1)},children:"Cancel"}),(0,g.jsx)(c.A,{type:"primary",htmlType:"submit",loading:b,children:"Submit"})]})]})})})})};var I=s(7047),F=s(1068),k=s(2013),N=s(8387),T=s(6059),O=s(6191),V=s(5337),P=s(8646),D=s(8240);const{Text:E,Title:q}=I.A,{Panel:W}=F.A,z=e=>{let{allData:t,setIsEditCms:s,setTableData:l,setVisible:r}=e;return(0,g.jsx)("div",{style:{padding:"1px"},children:(0,g.jsx)(i.A,{gutter:[16,16],children:t.map((e=>(0,g.jsx)(n.A,{xs:24,sm:12,md:8,lg:6,children:(0,g.jsxs)(k.A,{title:(0,g.jsx)(q,{level:5,children:(0,g.jsxs)("div",{className:"flex justify-between items-center",children:[(0,g.jsxs)("span",{className:"text-sm sm:text-base",children:["Table No:- ",e.table_number]}),(0,g.jsx)("span",{className:"ml-5 sm:ml-16 ",onClick:()=>{r(!0),l(e)},children:e.current_order?(0,g.jsxs)(N.A,{color:"blue",children:[(0,g.jsx)(O.A,{className:"mr-1"}),"view Order"]}):(0,g.jsxs)(N.A,{color:"green",children:[(0,g.jsx)(V.A,{className:"mr-1"}),"Add Order"]})})]})}),bordered:!1,style:{boxShadow:"0 4px 8px rgba(0, 0, 0, 0.1)",borderRadius:"8px"},children:[(0,g.jsx)(E,{strong:!0,children:"#ID: "}),(0,g.jsx)(E,{children:e.id}),(0,g.jsx)("br",{}),(0,g.jsx)(E,{strong:!0,children:"Total Seats: "}),(0,g.jsx)(E,{children:e.no_of_seats}),(0,g.jsx)("br",{}),(0,g.jsx)(E,{strong:!0,children:"Status: "}),"available"===e.status?(0,g.jsx)(N.A,{color:"green",children:e.status}):(0,g.jsx)(N.A,{color:"red",children:e.status}),(0,g.jsx)("br",{}),e.current_order&&(0,g.jsxs)(g.Fragment,{children:[(0,g.jsx)(E,{strong:!0,children:"Current Order: "}),"#"+e.current_order]}),!e.current_order&&(0,g.jsx)(g.Fragment,{children:(0,g.jsx)(E,{strong:!0,children:"Waiting For Orders"})}),(0,g.jsxs)("div",{className:"flex justify-between mt-2",children:[(0,g.jsx)(P.A,{onClick:()=>s({isOpen:!0,cmsId:null===e||void 0===e?void 0:e.id}),style:{cursor:"pointer",color:"#1890ff"}}),(0,g.jsx)(T.A,{title:"Are you sure to delete this Table?",onConfirm:()=>{},okText:"Yes",cancelText:"No",children:(0,g.jsx)(D.A,{onClick:()=>{},style:{cursor:"pointer",color:"#ff4d4f"}})})]})]})},e.id)))})})};var K=s(925),R=s(1734),B=s(7043),M=s(495);const{Search:H}=a.A,L=()=>{const[e,t]=(0,l.useState)(!1),[s,a]=(0,l.useState)(0),[h,x]=(0,l.useState)(""),[j,p]=(0,l.useState)(""),[b,v]=(0,r.fp)(M.qt),[f,_]=(0,r.fp)(M.oc),[S,w]=(0,l.useState)(!1),[I,F]=(0,l.useState)(0),[k,N]=(0,l.useState)(0),[T,O]=(0,l.useState)(!1),[V,P]=(0,l.useState)({isOpen:!1,cmsId:""}),[D,E]=(0,l.useState)([]),q=e=>{let{search:t,type:l,isAvailable:r}=e;(0,A.xH)({start:s,limit:12,search:t,type:l,isAvailable:r,store_id:b}).then((e=>{var t,s;e&&(E(null===e||void 0===e||null===(t=e.data)||void 0===t?void 0:t.rows),N(null===e||void 0===e||null===(s=e.data)||void 0===s?void 0:s.count))})).catch((e=>console.log("err",e)))};(0,l.useEffect)((()=>{q({search:h,type:j,isAvailable:S})}),[h,j,S,b,I,s]);return(0,g.jsxs)(g.Fragment,{children:[(0,g.jsx)(R.z,{title:"Tables",routes:[{path:"/",breadcrumbName:"Dashboard"},{path:"/tables",breadcrumbName:"Tables"}],className:"flex items-center justify-between px-8 xl:px-[15px] pt-2 pb-6 sm:pb-[30px] bg-transparent sm:flex-col"}),(0,g.jsx)(K.rQ,{className:"p-3",children:(0,g.jsx)(i.A,{gutter:16,children:(0,g.jsx)(n.A,{sm:24,xs:24,lg:24,className:"",children:(0,g.jsxs)(B.C,{title:(0,g.jsx)("div",{children:(0,g.jsxs)(i.A,{gutter:[16,16],align:"middle",children:[(0,g.jsx)(n.A,{xs:24,sm:12,md:6,children:(0,g.jsxs)(d.A,{style:{width:"100%"},size:"medium",placeholder:"Status",onChange:e=>{p(e)},children:[(0,g.jsx)(Option,{value:"",children:"All"}),(0,g.jsx)(Option,{value:"booked",children:"Booked"}),(0,g.jsx)(Option,{value:"available",children:"Available"}),(0,g.jsx)(Option,{value:"service",children:"Service"}),(0,g.jsx)(Option,{value:"preparing",children:"Preparing"})]})}),(0,g.jsx)(n.A,{xs:24,sm:8,md:6,children:(0,g.jsx)(H,{placeholder:"Table number",allowClear:!0,enterButton:"Search",size:"medium",onSearch:e=>{x(e)},style:{width:"100%"}})})]})}),moreBtn:(0,g.jsx)(c.A,{type:"primary",onClick:()=>t(!0),children:"Add"}),children:[(0,g.jsx)(z,{allData:D,setIsEditCms:P,setTableData:_,setVisible:O}),(0,g.jsx)("div",{className:"mt-2 flex justify-end",children:(0,g.jsx)(o.A,{pageSize:12,total:k,onChange:e=>{a(10*(e-1))},showSizeChanger:!1})})]})})})}),(0,g.jsx)(m.A,{title:"".concat(e?"Add Tables":"Edit Table"),destroyOnClose:!0,open:e||V.isOpen,width:1024,footer:!1,onCancel:()=>{t(!1),P({isOpen:!1,cmsId:""})},children:(0,g.jsx)(y,{setisAddCms:t,getAllData:q,isEditCms:V,setIsEditCms:P,currentStore:b,newRecord:I,setNewRecord:F})}),(0,g.jsx)(u.A,{title:f.current_order?"Update Order #"+f.current_order:"Add Order",placement:"right",onClose:()=>{O(!1)},open:T,width:window.innerWidth<768?300:600,children:(0,g.jsx)(C,{setVisible:O,tableData:f,visible:T,allCms:D,setAllCms:E,currentStore:b})})]})}},3815:(e,t,s)=>{s.d(t,{FM:()=>n,FN:()=>d,W8:()=>i,hV:()=>a,zF:()=>r});var l=s(2170);const r=async e=>{let{body:t}=e;return await l.p.post("/orders",t)},a=async e=>{let{start:t,limit:s,status:r,search:a,dates:i}=e,n=a?"&search=".concat(a):"",d=r?"&status=".concat(r):"",c="";2===i.length&&(c="&start_date=".concat(i[0],"&end_date=").concat(i[1]));return await l.p.get("/orders?start=".concat(t,"&limit=").concat(s).concat(n).concat(d).concat(c))},i=async e=>{let{id:t}=e;return await l.p.get("/orders/".concat(t))},n=async e=>{let{id:t,body:s}=e;return await l.p.patch("/orders/".concat(t),s)},d=async e=>{let{id:t}=e;return await l.p.delete("/orders/".concat(t))}},7807:(e,t,s)=>{s.d(t,{FM:()=>n,FN:()=>d,W8:()=>i,hV:()=>a,zF:()=>r});var l=s(2170);const r=async e=>{let{body:t}=e;return await l.p.post("/restroItems",t)},a=async e=>{let{start:t=0,limit:s=10,search:r}=e,a=r?"&search=".concat(r):"";return await l.p.get("/restroItems?start=".concat(t,"&limit=").concat(s).concat(a))},i=async e=>{let{id:t}=e;return await l.p.get("/restroItems/".concat(t))},n=async e=>{let{id:t,body:s}=e;return await l.p.patch("/restroItems/".concat(t),s)},d=async e=>{let{id:t}=e;return await l.p.delete("/restroItems/".concat(t))}},2543:(e,t,s)=>{s.d(t,{FM:()=>n,W8:()=>i,xH:()=>a,zF:()=>r});var l=s(2170);const r=async e=>{let{body:t}=e;return await l.p.post("/tables",t)},a=async e=>{let{start:t=0,limit:s=10,search:r,type:a,isAvailable:i,store_id:n}=e,d=r?"&search=".concat(r):"",c=a?"&status=".concat(a):"",o=n?"&store_id=".concat(n):"",m=i?"&isAvailable=".concat(i):"";return await l.p.get("/tables?start=".concat(t,"&limit=").concat(s).concat(d).concat(c).concat(m).concat(o))},i=async e=>{let{id:t}=e;return await l.p.get("/tables/".concat(t))},n=async e=>{let{id:t,body:s}=e;return await l.p.patch("/tables/".concat(t),s)}}}]);
//# sourceMappingURL=828.cb8ed4c5.chunk.js.map